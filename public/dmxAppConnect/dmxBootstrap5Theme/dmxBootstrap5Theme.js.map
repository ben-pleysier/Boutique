{"version":3,"sources":["components/theme.js","components/themeSwitch.js"],"names":["dmx","Component","initialData","theme","attributes","key","type","String","default","enum","methods","setTheme","this","props","performUpdate","render","init","_changeHandler","bind","_mediaQuery","window","matchMedia","addEventListener","_getStoredTheme","_update","destroy","removeEventListener","_setStoredTheme","document","documentElement","setAttribute","matches","set","event","localStorage","getItem","setItem","icons","manager","events","change","Event","node","_icons","bi","auto","check","dark","light","fa","_prefix","id","$watch","isNavItem","classList","contains","parentNode","add","innerHTML","querySelectorAll","forEach","toggle","getAttribute","_setTheme","querySelector","focus","Map","updatedProps","$node","element","remove","activeThemeIcon","Object","values","cls","split","has","parse","dispatchEvent"],"mappings":"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","file":"dmxBootstrap5Theme.js","sourcesContent":["dmx.Component('bs5-theme', {\r\n  initialData: {\r\n    theme: 'auto',\r\n  },\r\n\r\n  attributes: {\r\n    key: {\r\n      type: String,\r\n      default: 'theme',\r\n    },\r\n\r\n    theme: {\r\n      type: String,\r\n      default: 'auto',\r\n      enum: ['auto', 'light', 'dark'],\r\n    },\r\n  },\r\n\r\n  methods: {\r\n    setTheme (theme) {\r\n      this.props.theme = theme;\r\n      this.performUpdate();\r\n    },\r\n  },\r\n\r\n  render: false,\r\n\r\n  init () {\r\n    this._changeHandler = this._changeHandler.bind(this);\r\n    this._mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');\r\n    this._mediaQuery.addEventListener('change', this._changeHandler);\r\n    this.props.theme = this._getStoredTheme() || this.props.theme;\r\n    this._update();\r\n  },\r\n\r\n  destroy () {\r\n    this._mediaQuery.removeEventListener('change', this._changeHandler);\r\n  },\r\n\r\n  performUpdate () {\r\n    this._setStoredTheme(this.props.theme);\r\n    this._update();\r\n  },\r\n  \r\n  _update () {\r\n    if (this.props.theme === 'auto') {\r\n      document.documentElement.setAttribute('data-bs-theme', this._mediaQuery.matches ? 'dark' : 'light');\r\n    } else {\r\n      document.documentElement.setAttribute('data-bs-theme', this.props.theme);\r\n    }\r\n\r\n    this.set('theme', this.props.theme);\r\n  },\r\n\r\n  _changeHandler (event) {\r\n    this._update();\r\n  },\r\n\r\n  _getStoredTheme () {\r\n    return localStorage.getItem(this.props.key);\r\n  },\r\n\r\n  _setStoredTheme (theme) {\r\n    localStorage.setItem(this.props.key, theme);\r\n  },\r\n\r\n});","dmx.Component('bs5-theme-switch', {\r\n\r\n  attributes: {\r\n    icons: {\r\n      type: String,\r\n      default: 'bi',\r\n      enum: ['bi', 'fa'],\r\n    },\r\n\r\n    manager: {\r\n      type: String,\r\n      default: '',\r\n    }\r\n  },\r\n\r\n  events: {\r\n    change: Event,\r\n  },\r\n\r\n  init (node) {\r\n    this._icons = {\r\n      bi: {\r\n        auto: 'bi-circle-half',\r\n        check: 'bi-check2',\r\n        dark: 'bi-moon-stars-fill',\r\n        light: 'bi-sun-fill',\r\n      },\r\n      fa: {\r\n        auto: 'fa-adjust',\r\n        check: 'fa-check',\r\n        dark: 'fa-moon fa-moon-o',\r\n        light: 'fa-sun fa-sun-o',\r\n      },\r\n    };\r\n\r\n    this._prefix = node.id;\r\n    this.props.theme = 'auto';\r\n\r\n    if (this.props.manager) {\r\n      this.$watch(`${this.props.manager}.theme`, theme => {\r\n        this.props.theme = theme;\r\n      });\r\n    }\r\n  },\r\n\r\n  render (node) {\r\n    const icons = this._icons[this.props.icons];\r\n    const isNavItem = node.classList.contains('nav-item') || node.parentNode.classList.contains('nav-item');\r\n\r\n    node.classList.add('dropdown');\r\n\r\n    node.innerHTML = `\r\n      <button class=\"btn ${isNavItem ? 'btn-link nav-link' : 'btn-primary'} py-2 dropdown-toggle d-flex align-items-center\" id=\"${this._prefix}-theme\" type=\"button\" aria-expanded=\"false\" data-bs-toggle=\"dropdown\" aria-label=\"Toggle theme (auto)\">\r\n        <i class=\"${this.props.icons} ${icons.auto} ${this.props.icons == 'fa' ? 'my-1' : ''} theme-icon-active\"></i>\r\n        <span class=\"visually-hidden\" id=\"${this._prefix}-theme-text\">Toggle theme</span>\r\n      </button>\r\n      <ul class=\"dropdown-menu dropdown-menu-end\" aria-labelledby=\"${this._prefix}-theme-text\">\r\n        <li>\r\n          <button type=\"button\" class=\"dropdown-item d-flex align-items-center\" data-bs-theme-value=\"light\" aria-pressed=\"false\">\r\n            <i class=\"${this.props.icons} ${icons.light} me-2 opacity-50\"></i>\r\n            Light\r\n            <i class=\"${this.props.icons} ${icons.check} ms-auto d-none\"></i>\r\n          </button>\r\n        </li>\r\n        <li>\r\n          <button type=\"button\" class=\"dropdown-item d-flex align-items-center\" data-bs-theme-value=\"dark\" aria-pressed=\"false\">\r\n            <i class=\"${this.props.icons} ${icons.dark} me-2 opacity-50\"></i>\r\n            Dark\r\n            <i class=\"${this.props.icons} ${icons.check} ms-auto d-none\"></i>\r\n          </button>\r\n        </li>\r\n        <li>\r\n          <button type=\"button\" class=\"dropdown-item d-flex align-items-center\" data-bs-theme-value=\"auto\" aria-pressed=\"true\">\r\n            <i class=\"${this.props.icons} ${icons.auto} me-2 opacity-50\"></i>\r\n            Auto\r\n            <i class=\"${this.props.icons} ${icons.check} ms-auto d-none\"></i>\r\n          </button>\r\n        </li>\r\n      </ul>\r\n    `;\r\n\r\n    node.querySelectorAll('[data-bs-theme-value]').forEach(toggle => {\r\n      toggle.addEventListener('click', () => {\r\n        \tthis.props.theme = toggle.getAttribute('data-bs-theme-value');\r\n          this._setTheme(this.props.theme);\r\n          node.querySelector(`#${this._prefix}-theme`).focus();\r\n      });\r\n    });\r\n\r\n    this.performUpdate(new Map());\r\n  },\r\n\r\n  performUpdate (updatedProps) {\r\n    const icons = this._icons[this.props.icons];\r\n\r\n    this.$node.querySelectorAll('[data-bs-theme-value]').forEach(element => {\r\n      if (element.getAttribute('data-bs-theme-value') === this.props.theme) {\r\n        element.classList.add('active');\r\n        element.setAttribute('aria-pressed', 'true');\r\n        element.querySelector('.' + icons.check).classList.remove('d-none');\r\n      } else {\r\n        element.classList.remove('active');\r\n        element.setAttribute('aria-pressed', 'false');\r\n        element.querySelector('.' + icons.check).classList.add('d-none');\r\n      }\r\n    });\r\n\r\n    const activeThemeIcon = this.$node.querySelector('.theme-icon-active');\r\n    Object.values(icons).forEach(cls => activeThemeIcon.classList.remove(...cls.split(' ')));\r\n    activeThemeIcon.classList.add(...icons[this.props.theme].split(' '));\r\n    \r\n    const themeSwitcher = this.$node.querySelector(`#${this._prefix}-theme`);\r\n    themeSwitcher.setAttribute('aria-label', `Toggle theme (${this.props.theme})`);\r\n\r\n    if (updatedProps.has('manager')) {\r\n      if (this.props.manager) {\r\n        // TODO: remove previous watch\r\n        this.$watch(`${this.props.manager}.theme`, theme => {\r\n          this.props.theme = theme;\r\n        });\r\n      }\r\n    }\r\n  },\r\n\r\n  destroy () {\r\n  },\r\n\r\n  _setTheme (theme) {\r\n    if (this.props.manager) {\r\n      this.parse(`${this.props.manager}.setTheme(\"${theme}\")`);\r\n    }\r\n    this.dispatchEvent('change', {}, { theme });\r\n  },\r\n\r\n});"]}